---
title: "第2章: はじめてのMicrosoft Entra ID〜ID管理の基本〜"
---

# はじめに

第1章では、Microsoftクラウドサービスの全体像を学びました。この章では、すべてのMicrosoftクラウドサービスの「認証の中心」となるMicrosoft Entra ID（旧Azure AD）について、基本的な概念から実際の管理操作まで詳しく学んでいきます。

Microsoft Entra IDは、企業のID管理システムの中核となる重要なサービスです。新人エンジニアの方でも理解しやすいよう、基本概念から段階的に説明していきます。

## 2.1 Microsoft Entra IDの基本理解

### 2.1.1 Microsoft Entra IDとは

#### ID管理システムの役割

**ID管理システム**とは、組織内のユーザーが誰であるかを管理し、どのシステムにアクセスできるかを制御するシステムです。まるで会社の「社員証管理システム」のようなものと考えるとわかりやすいでしょう。

**ID管理システムの主な機能：**
- **認証（Authentication）**: 「あなたは誰ですか？」を確認
- **認可（Authorization）**: 「何にアクセスできますか？」を制御
- **監査（Auditing）**: 「いつ、誰が、何をしたか」を記録

#### Microsoft Entra ID（旧Azure AD）の位置付け

**Microsoft Entra ID**は、Microsoftが提供するクラウドベースのID管理サービスです。2023年7月に「Azure Active Directory」から改名されました。

**特徴：**
- **クラウドファースト**: インターネット経由でどこからでも利用可能
- **高い可用性**: 99.9%の稼働率を保証
- **スケーラビリティ**: 数人から数万人まで対応可能
- **セキュリティ**: 企業レベルのセキュリティ機能

#### Active Directory（オンプレミス）との違い

多くの企業で使用されている従来のActive Directory（AD）とMicrosoft Entra IDの違いを理解しましょう。

**従来のActive Directory（オンプレミス）**
- **設置場所**: 会社内のサーバー
- **アクセス**: 社内ネットワークからのみ
- **管理**: 自社のIT部門が担当
- **コスト**: サーバー購入・維持費用が必要

**Microsoft Entra ID（クラウド）**
- **設置場所**: Microsoftのデータセンター
- **アクセス**: インターネット経由でどこからでも
- **管理**: 基盤はMicrosoftが管理
- **コスト**: 使用ライセンス料のみ

### 📊 オンプレミスAD vs Microsoft Entra ID

```
┌─────────────────────┬─────────────────────┐
│   オンプレミスAD    │  Microsoft Entra ID │
├─────────────────────┼─────────────────────┤
│ 社内サーバーに設置  │ クラウドサービス    │
│ 社内からのみアクセス│ どこからでもアクセス│
│ 自社で管理・運用    │ Microsoftが基盤管理 │
│ 初期投資が高額      │ 月額ライセンス料    │
│ カスタマイズ自由    │ 標準機能が充実      │
└─────────────────────┴─────────────────────┘
```

### 2.1.2 テナントの理解と初期設定

#### テナントの概念と役割

**テナント（Tenant）**とは、Microsoft Entra IDにおける組織の単位です。まるで「アパートの一室」のようなもので、一つの会社が一つのテナントを持ちます。

**テナントの特徴：**
- **独立性**: 他の組織のデータと完全に分離
- **一意性**: 会社ごとに固有のテナント名
- **管理範囲**: そのテナント内のユーザーとリソースを管理

**テナント名の例：**
- `contoso.onmicrosoft.com`
- `yamada-corp.onmicrosoft.com`
- `abc-company.onmicrosoft.com`

#### カスタムドメインの追加と検証

企業では、独自のドメイン名（例：`@yourcompany.com`）を使用したいものです。Microsoft Entra IDでは、カスタムドメインを追加できます。

**カスタムドメイン設定の流れ：**

1. **ドメイン名の追加**
   - Microsoft Entra ID管理センターでドメイン追加
   - 会社のドメイン名を入力（例：`yourcompany.com`）

2. **所有権の確認**
   - MicrosoftがDNSレコードを提供
   - ドメイン管理者がDNSレコードを追加
   - Microsoftが所有権を確認

3. **ドメインの検証**
   - 検証完了後、カスタムドメインが利用可能
   - ユーザーは`@yourcompany.com`でログイン可能

**📋 実践：ドメイン設定の手順書**

```
1. Microsoft Entra ID管理センターにアクセス
2. [カスタムドメイン名] を選択
3. [カスタムドメインの追加] をクリック
4. ドメイン名を入力（例：yourcompany.com）
5. 提供されたDNSレコードをドメインプロバイダーに追加
6. [確認] をクリックして検証完了
```

### 2.1.3 管理ポータルの使い方

#### Azure portal vs Microsoft 365 admin center の使い分け

Microsoft Entra IDの管理は、主に2つのポータルから行います。

**Azure portal（portal.azure.com）**
- **用途**: 技術的な設定、詳細な管理
- **対象**: IT管理者、システム管理者
- **機能**: 高度な設定、API管理、監査ログ
- **特徴**: 技術者向けの詳細なインターフェース

**Microsoft 365 admin center（admin.microsoft.com）**
- **用途**: 日常的な管理、基本的な設定
- **対象**: 一般的な管理者
- **機能**: ユーザー管理、ライセンス管理、基本設定
- **特徴**: 使いやすいインターフェース

#### 基本的なナビゲーションと画面の見方

**Azure portalの基本構成：**
- **左側メニュー**: 主要なサービス一覧
- **検索バー**: サービス名で素早く検索
- **ダッシュボード**: よく使う機能のショートカット
- **通知**: システムからの重要な通知

**Microsoft 365 admin centerの基本構成：**
- **ホーム**: 全体の状況を把握
- **ユーザー**: ユーザー管理の中心
- **課金**: ライセンスとコスト管理
- **設定**: 各種設定の変更

**🖥️ 主要な管理画面の紹介**

```
Azure portal での主要メニュー：
├── Microsoft Entra ID
│   ├── 概要（全体の状況）
│   ├── ユーザー（ユーザー管理）
│   ├── グループ（グループ管理）
│   ├── アプリケーション（アプリ管理）
│   └── セキュリティ（セキュリティ設定）
```

## 2.2 ユーザー管理の実践

### 2.2.1 ユーザーアカウントの基本管理

#### ユーザーの作成手順

新しいユーザーを作成する際の具体的な手順を説明します。

**📋 実践：ユーザーの作成手順（画面付き）**

**Azure portalでの手順：**
1. **Azure portal** (`portal.azure.com`) にアクセス
2. **Microsoft Entra ID** を選択
3. **ユーザー** > **すべてのユーザー** を選択
4. **新しいユーザー** をクリック
5. **ユーザーの作成** を選択

**入力項目：**
- **ユーザープリンシパル名**: `tanaka@yourcompany.com`
- **表示名**: `田中 太郎`
- **名**: `太郎`
- **姓**: `田中`
- **役職**: `営業部 主任`
- **部署**: `営業部`

**パスワード設定：**
- **自動生成**: システムが安全なパスワードを自動生成
- **手動設定**: 独自のパスワードを設定
- **初回ログイン時変更**: 初回ログイン時に変更を強制

#### プロファイル情報の設定

ユーザーのプロファイル情報を詳細に設定することで、組織内での連絡や管理が効率化されます。

**基本情報：**
- **名前**: 姓名の設定
- **表示名**: 組織内での表示名
- **ユーザープリンシパル名**: ログイン時のメールアドレス

**連絡先情報：**
- **メールアドレス**: 業務用メールアドレス
- **電話番号**: 携帯電話・内線番号
- **オフィス**: 勤務地・オフィス名

**組織情報：**
- **役職**: 役職名
- **部署**: 所属部署
- **マネージャー**: 上司の設定

#### パスワードポリシーの設定と管理

強固なパスワードポリシーを設定することで、セキュリティを向上させます。

**基本的なパスワードポリシー：**
- **最小文字数**: 8文字以上
- **複雑さの要求**: 大文字・小文字・数字・記号を含む
- **有効期限**: 90日〜180日
- **履歴**: 過去12個のパスワードを記録
- **アカウントロックアウト**: 5回の失敗でアカウントロック

**高度なパスワードポリシー：**
- **禁止パスワード**: 一般的なパスワードを禁止
- **カスタム禁止リスト**: 会社名・製品名を禁止
- **漏洩パスワード検出**: 既知の漏洩パスワードを検出

**📋 チェックリスト：新規ユーザー作成時の確認事項**

```
□ ユーザープリンシパル名が正しく設定されている
□ 表示名が組織の命名規則に従っている
□ 部署・役職情報が正確に入力されている
□ 適切なライセンスが割り当てられている
□ 必要なグループに追加されている
□ 初回ログイン時のパスワード変更が設定されている
□ マネージャーが適切に設定されている
□ セキュリティ設定が組織の方針に適合している
```

### 2.2.2 ライセンス管理

#### ライセンスの種類と割り当て方法

Microsoft 365のライセンスには複数の種類があり、ユーザーの役割に応じて適切なライセンスを割り当てる必要があります。

**主要なライセンス種類：**
- **Microsoft 365 Business Basic**: 基本的なクラウドアプリ
- **Microsoft 365 Business Standard**: デスクトップアプリ込み
- **Microsoft 365 Business Premium**: 高度なセキュリティ機能
- **Microsoft 365 E3**: 大企業向け標準プラン
- **Microsoft 365 E5**: 最高レベルの機能

#### ライセンス割り当ての実践

**📋 実践：ライセンス割り当ての手順**

**Microsoft 365 admin centerでの手順：**
1. **Microsoft 365 admin center** (`admin.microsoft.com`) にアクセス
2. **ユーザー** > **アクティブなユーザー** を選択
3. 対象ユーザーを選択
4. **ライセンスとアプリ** タブを選択
5. 必要なライセンスにチェック
6. **変更の保存** をクリック

**Azure portalでの手順：**
1. **Azure portal** にアクセス
2. **Microsoft Entra ID** > **ユーザー** を選択
3. 対象ユーザーを選択
4. **ライセンス** を選択
5. **割り当て** をクリック
6. 必要な製品を選択して **保存**

#### コスト効率的なライセンス管理

**ライセンス最適化の考え方：**

1. **役割別ライセンス設計**
   - **経営層**: E5（高度な分析・セキュリティ）
   - **管理職**: E3（管理機能・コンプライアンス）
   - **一般職**: Business Standard（基本機能）
   - **パートタイム**: Business Basic（最小限の機能）

2. **段階的ライセンス適用**
   - **初期**: Basic から開始
   - **習熟**: Standard にアップグレード
   - **必要時**: Premium/Enterprise に移行

3. **定期的な見直し**
   - **月次**: 使用状況の確認
   - **四半期**: ライセンス最適化
   - **年次**: 全体的な見直し

**📋 注意点：ライセンス変更時の影響**

```
ライセンスアップグレード時：
□ 新機能が即座に利用可能
□ データは保持される
□ 設定は引き継がれる

ライセンスダウングレード時：
□ 一部機能が利用不可になる
□ データは一定期間保持される
□ 設定によっては変更が必要

ライセンス削除時：
□ アカウントは無効化される
□ データは30日間保持される
□ 復元には再ライセンス割り当てが必要
```

### 2.2.3 グループ管理

#### セキュリティグループ vs Microsoft 365グループ

Microsoftのグループには主に2つの種類があります。それぞれの特徴と使い分けを理解しましょう。

**セキュリティグループ**
- **目的**: アクセス許可の管理
- **用途**: ファイル共有、アプリケーションアクセス
- **特徴**: セキュリティ重視、シンプルな構成
- **例**: 「経理部」「管理職」「IT管理者」

**Microsoft 365グループ**
- **目的**: コラボレーション
- **用途**: Teams、SharePoint、Outlook共有
- **特徴**: 多機能、自動的にリソース作成
- **例**: 「新商品開発プロジェクト」「マーケティング」

#### グループ作成と管理の実践

**📋 実践：グループ作成と管理**

**セキュリティグループの作成：**
1. **Azure portal** > **Microsoft Entra ID** > **グループ**
2. **新しいグループ** をクリック
3. **グループの種類**: セキュリティ
4. **グループ名**: 「営業部」
5. **説明**: 「営業部門のメンバー」
6. **メンバーシップの種類**: 割り当て済み
7. **メンバーを追加** でユーザーを選択

**Microsoft 365グループの作成：**
1. **Microsoft 365 admin center** > **グループ**
2. **グループの追加** をクリック
3. **種類**: Microsoft 365
4. **名前**: 「新製品開発チーム」
5. **説明**: 「新製品開発プロジェクト」
6. **プライバシー**: プライベート
7. **メンバーを追加**

#### 動的グループの活用

**動的グループ**とは、設定した条件に基づいて自動的にメンバーが追加・削除されるグループです。

**動的グループの利点：**
- **自動化**: 手動でのメンバー管理が不要
- **正確性**: 条件に基づく正確なメンバー管理
- **効率性**: 大規模組織での管理負荷軽減

**動的グループの条件例：**
- **部署による分類**: `user.department -eq "営業部"`
- **役職による分類**: `user.jobTitle -contains "マネージャー"`
- **場所による分類**: `user.city -eq "東京"`
- **複合条件**: `(user.department -eq "営業部") -and (user.city -eq "東京")`

**📋 ベストプラクティス：グループ設計の考え方**

```
グループ設計の原則：
1. 目的を明確にする
   - セキュリティ目的 → セキュリティグループ
   - コラボレーション目的 → Microsoft 365グループ

2. 命名規則を統一する
   - 部署：「dept-営業部」
   - プロジェクト：「proj-新製品開発」
   - 役職：「role-マネージャー」

3. 階層構造を考慮する
   - 大グループ：「全社員」
   - 中グループ：「営業部」
   - 小グループ：「東京営業部」

4. 管理者を明確にする
   - グループオーナーの設定
   - 管理責任者の明確化
   - 定期的な見直し担当者
```

## 2.3 基本的なセキュリティ設定

### 2.3.1 多要素認証（MFA）の設定

#### MFAが必要な理由

**多要素認証（MFA）**は、現代のサイバーセキュリティにおいて必須の対策です。

**従来のパスワード認証の問題点：**
- **漏洩リスク**: データ漏洩によるパスワード流出
- **推測攻撃**: 辞書攻撃、ブルートフォース攻撃
- **使い回し**: 複数サービスでの同一パスワード使用
- **フィッシング**: 偽サイトでのパスワード盗取

**MFAによる保護効果：**
- **99.9%以上の攻撃を防止**: Microsoftの統計より
- **アカウント乗っ取りの防止**: パスワードのみでは不十分
- **リアルタイム通知**: 不正アクセスの即座の検知

#### MFAの有効化手順

**📋 実践：MFAの有効化手順**

**Microsoft 365 admin centerでの設定：**
1. **Microsoft 365 admin center** にアクセス
2. **設定** > **セキュリティとプライバシー** > **多要素認証**
3. **多要素認証の管理** をクリック
4. 対象ユーザーを選択
5. **有効にする** または **強制** を選択
6. **保存** をクリック

**Azure portalでの設定：**
1. **Azure portal** > **Microsoft Entra ID** > **セキュリティ**
2. **多要素認証** を選択
3. **追加のクラウドベースの MFA 設定** をクリック
4. **ユーザー設定** でユーザーを選択
5. **有効化** または **強制** を選択

#### 認証方法の選択と推奨設定

**利用可能な認証方法：**

1. **Microsoft Authenticator アプリ**
   - **推奨度**: ★★★★★
   - **利点**: 高いセキュリティ、使いやすさ
   - **設定**: スマートフォンアプリをインストール

2. **SMSテキストメッセージ**
   - **推奨度**: ★★★☆☆
   - **利点**: 設定が簡単
   - **欠点**: SIMスワップ攻撃のリスク

3. **音声通話**
   - **推奨度**: ★★☆☆☆
   - **利点**: スマートフォンが不要
   - **欠点**: 効率性に劣る

4. **ハードウェアトークン**
   - **推奨度**: ★★★★☆
   - **利点**: 最高レベルのセキュリティ
   - **欠点**: コストが高い

**推奨設定：**
- **第一選択**: Microsoft Authenticator
- **バックアップ**: SMS または音声通話
- **管理者**: ハードウェアトークンの併用

#### よくある問題と解決法

**📋 トラブルシューティング：よくある問題と解決法**

**問題1: スマートフォンを紛失・故障した場合**
```
解決法：
1. 管理者による一時的なMFA無効化
2. 新しいデバイスでのAuthenticator再設定
3. バックアップコードの使用
4. 代替認証方法の利用
```

**問題2: 海外出張時にSMSが届かない場合**
```
解決法：
1. Microsoft Authenticatorアプリの利用
2. 音声通話による認証
3. 事前のバックアップコード取得
4. 管理者による一時的な地域設定変更
```

**問題3: アプリパスワードが必要な場合**
```
解決法：
1. Microsoft 365 admin centerでアプリパスワード生成
2. 古いメールクライアントでの使用
3. 定期的なアプリパスワード更新
4. 可能であれば最新クライアントへの移行
```

### 2.3.2 パスワードポリシーとサインインセキュリティ

#### 安全なパスワードポリシーの設定

**基本的なパスワードポリシー：**
- **最小文字数**: 12文字以上を推奨
- **複雑さの要求**: 大文字・小文字・数字・記号
- **有効期限**: 定期的な変更（90-180日）
- **履歴**: 過去24個のパスワードを記録
- **アカウントロックアウト**: 5回の失敗で30分間ロック

**高度なパスワード保護：**
- **Microsoft Entra ID Password Protection**: 弱いパスワードの自動検出
- **カスタム禁止リスト**: 会社固有の禁止語句
- **漏洩パスワード検出**: 既知の漏洩パスワードの拒否
- **コンテキスト認識**: ユーザー名を含むパスワードの拒否

#### サインインログの確認方法

**📋 実践：異常なサインインの検知と対応**

**サインインログの確認手順：**
1. **Azure portal** > **Microsoft Entra ID** > **サインイン**
2. **日付範囲** を設定
3. **ユーザー** または **アプリケーション** でフィルタリング
4. **場所** や **デバイス** で異常を検知

**確認すべき項目：**
- **異常な場所**: 通常と異なる地域からのアクセス
- **異常な時間**: 業務時間外のアクセス
- **失敗したサインイン**: 複数回の失敗試行
- **新しいデバイス**: 未知のデバイスからのアクセス

**対応手順：**
1. **即座の対応**: 異常検知時のアカウント無効化
2. **調査**: ログの詳細分析
3. **復旧**: 安全確認後のアカウント復旧
4. **報告**: インシデント報告書の作成

### 2.3.3 条件付きアクセス入門

#### 条件付きアクセスポリシーの基本概念

**条件付きアクセス**とは、特定の条件下でのみアクセスを許可するセキュリティ機能です。

**基本的な仕組み：**
```
IF（条件）THEN（アクション）
例：IF（社外からのアクセス）THEN（MFAを要求）
```

**主な条件：**
- **場所**: IPアドレス、国・地域
- **デバイス**: 管理されたデバイス、OS種類
- **アプリケーション**: 特定のアプリケーション
- **時間**: 業務時間、曜日
- **リスク**: サインインリスク、ユーザーリスク

**主なアクション：**
- **アクセス許可**: 条件を満たした場合のアクセス許可
- **アクセス拒否**: 条件を満たさない場合のアクセス拒否
- **追加認証**: MFAの要求
- **利用規約**: 利用規約の同意要求

#### シンプルな条件付きアクセスの設定

**📋 実践：シンプルな条件付きアクセスの設定**

**例：社外からのアクセス時にMFAを要求**

**設定手順：**
1. **Azure portal** > **Microsoft Entra ID** > **セキュリティ**
2. **条件付きアクセス** を選択
3. **新しいポリシー** をクリック
4. **名前**: 「社外アクセス時のMFA要求」

**条件の設定：**
- **ユーザー**: 「すべてのユーザー」
- **クラウドアプリ**: 「すべてのクラウドアプリ」
- **場所**: 「すべての場所」から「信頼できる場所」を除外

**アクセス制御の設定：**
- **許可**: 「アクセス権の付与」
- **要求**: 「多要素認証が必要」

#### 場所ベースのアクセス制御

**信頼できる場所の定義：**
- **会社のオフィス**: 固定IPアドレス
- **支社・営業所**: 各拠点のIPアドレス
- **VPN接続**: VPNサーバーのIPアドレス
- **在宅勤務**: 許可された自宅のIPアドレス

**場所ベースポリシーの例：**
1. **オフィス内**: 通常のアクセス
2. **国内の信頼できる場所**: MFA必須
3. **海外**: 管理者承認が必要
4. **高リスク地域**: アクセス拒否

**📋 注意点：設定時の考慮事項**

```
条件付きアクセス設定時の注意点：
1. 段階的な展開
   - テストグループでの検証
   - 段階的な本格展開
   - 緊急時の無効化手順

2. 緊急アクセス手順
   - 緊急時管理者アカウントの除外
   - 緊急時のポリシー無効化手順
   - 代替アクセス方法の確保

3. ユーザーへの影響
   - 事前の通知とトレーニング
   - ヘルプデスク対応の準備
   - ユーザーガイドの作成

4. 定期的な見直し
   - ポリシーの効果測定
   - 誤検知の確認と調整
   - セキュリティ要件の変更対応
```

## まとめ

この章では、Microsoft Entra IDの基本概念から実際の管理操作まで学びました。

### 重要なポイント

1. **Microsoft Entra IDの理解**
   - クラウドベースのID管理システム
   - オンプレミスADとの違い
   - テナントの概念と管理

2. **実践的なユーザー管理**
   - ユーザー作成と設定
   - ライセンス管理
   - グループ管理

3. **セキュリティの基本実装**
   - 多要素認証の必須化
   - パスワードポリシーの設定
   - 条件付きアクセスの活用

4. **日常的な運用管理**
   - サインインログの監視
   - 異常検知と対応
   - 定期的な見直し

次章では、Microsoft 365の各サービス（Exchange Online、Teams、SharePoint）の基本設定と管理方法について詳しく学んでいきます。